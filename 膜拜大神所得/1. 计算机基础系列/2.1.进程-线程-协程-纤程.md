# 进程（Process） - 线程（Thread） - 协程（Coroutine） - 纤程（Fiber）

1. IP 地址定位计算机，端口号定位进程
2. 一个进程可以有多个端口，一个端口通常只能被一个进程绑定
3. 操作系统通过端口号将网络数据正确分发给对应的进程
4. 完整的网络通信需要四元组：源 IP:源端口 ↔ 目标 IP:目标端口

## 进程

它是一个程序的运行实例；当我们启动一个程序，操作系统会分配一块内存给代码和运行时的数据使用，并且创建一个线程来处理任务，这样一个环境就叫做进程。

程序执行的时间总和（包含上下文切换） = CPU 加载上下文 + CPU 执行 + CPU 保存上下文；

## 线程

它是一个进程的执行任务或者也可以叫做控制单元；负责当前进程中程序的执行。一个进程至少有一个线程；

要实现程序 A，实际分成 a，b，c 等多个步骤；程序 A 得到 CPU =》CPU 加载上下文，开始执行程序 A 的 a 小段，然后执行 A 的 b 小段，然后再执行 A 的 c 小段，最后 CPU 保存 A 的上下文。  
**这里的 a，b，c 就是线程，也就是说线程是共享了进程的上下文环境，更为细小的 CPU 时间段。**

## 进程 与 线程

1. 一个进程包含一个或多个线程；
2. 当一个进程关闭后，操作系统会回收进程所占用的内存;
3. 进程之间相互隔离，如果需要访问需要依赖进程间通讯机制（即 IPC）；

4. 线程不能单独存在，它是由进程来启动和管理的;
5. 多线程可以并行处理任务;
6. 同一进程中，线程之间共享进程中的数据;
7. 任意一线程执行出错，都会导致整个进程的崩溃;

- js 是单线程的（假如有 2 个线程同时操作 dom）;
- 协程不受操作系统管理，而是被具体的应用程序代码所控制;

## 协程 (例：Generator)

可以将协程理解为线程中的一个个任务，一个线程可以存在多个协程；多个协程不能一起执行，一个线程一次只能执行一个协程;  
比如当前执行 A 协程，另外还有一个 B 协程，如果想要执行 B 的任务，就必须在 A 协程中将 **JS 线程的控制权转交给 B 协程**，那么现在 B 执行，A 就相当于处于暂停的状态。

    ``` code
        function* A() {
          console.log("我是A");
          yield B(); // A停住，在这里转交线程执行权给B
          console.log("结束了");
        }
        function B() {
          console.log("我是B");
          return 100;// 返回，并且将线程执行权还给A
        }
        let gen = A();
        gen.next();
        gen.next();

        // 我是A
        // 我是B
        // 结束了
    ```

## 纤程

React 内部实现的一套状态更新机制。支持任务不同优先级，可中断与恢复，并且恢复后可以复用之前的中间状态。

## 协程与纤程

1.相同：可以将纤程(Fiber)、协程(Generator)理解为代数效应思想在 JS 中的体现；  
2.区别：协程 不能返回上次计算的结果；纤程可以保存每次计算的结果
