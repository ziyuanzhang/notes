# 进程（Process） - 线程（Thread） - 协程（Coroutine） - 纤程（Fiber）

1. IP 地址定位计算机，端口号定位进程
2. 一个进程可以有多个端口，一个端口通常只能被一个进程绑定
3. 操作系统通过端口号将网络数据正确分发给对应的进程
4. 完整的网络通信需要四元组：源 IP:源端口 ↔ 目标 IP:目标端口

**注：** 同一个软件，不同电脑，端口号可能不同；

## 进程

它是一个程序的运行实例；当我们启动一个程序，操作系统会分配一块内存给“代码和运行时的数据”使用，并且创建一个线程来处理任务，这样一个环境就叫做进程。

程序执行的时间总和（包含上下文切换） = CPU 加载上下文 + CPU 执行 + CPU 保存上下文；

1. 一个进程至少包含一个线程（主线程）。
2. 当一个进程关闭后，操作系统会回收进程所占用的内存;
3. 多进程提供更强的隔离性和稳定性（例：浏览器每个标签页），如果需要访问需要依赖进程间通讯机制（即 IPC）；

优点：可以用多核，缺点：资源开销大

## 线程

是进程中的一个执行单元，是 CPU 调度的基本单位。一个进程可以包含多个线程，这些线程共享进程的内存空间和资源（如打开的文件、全局变量等），但每个线程有自己的栈和寄存器状态。

## 进程 与 线程

1. 线程不能单独存在，它是由进程来启动和管理的;
2. 多线程可提高程序的并发性和响应速度;
3. 同一进程中，线程之间共享进程中的数据;
4. 任意一线程执行出错，都会导致整个进程的崩溃;

优点：资源开销小，缺点：不能用多核

多线程共享内存时，需使用同步机制（如互斥锁 mutex、信号量 semaphore、条件变量等）避免竞态条件（Race Condition）。

- js 是单线程的（假如有 2 个线程同时操作 dom）;
- 协程不受操作系统管理，而是被具体的应用程序代码所控制;

## 协程 (例：Generator)

可以将协程理解为线程中的一个个任务，一个线程可以存在多个协程；多个协程不能一起执行，一个线程一次只能执行一个协程;  
比如当前执行 A 协程，另外还有一个 B 协程，如果想要执行 B 的任务，就必须在 A 协程中将 **JS 线程的控制权转交给 B 协程**，那么现在 B 执行，A 就相当于处于暂停的状态。

    ``` code
        function* A() {
          console.log("我是A");
          yield B(); // A停住，在这里转交线程执行权给B
          console.log("结束了");
        }
        function B() {
          console.log("我是B");
          return 100;// 返回，并且将线程执行权还给A
        }
        let gen = A();
        gen.next();
        gen.next();

        // 我是A
        // 我是B
        // 结束了
    ```

## 纤程

React 内部实现的一套状态更新机制。支持任务不同优先级，可中断与恢复，并且恢复后可以复用之前的中间状态。

## 协程与纤程

1.相同：可以将纤程(Fiber)、协程(Generator)理解为代数效应思想在 JS 中的体现；  
2.区别：协程 不能返回上次计算的结果；纤程可以保存每次计算的结果
