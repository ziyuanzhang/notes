# OSI 七层模型--开放式系统互联模型 ( 只是概念模型 -- 没有实际用 )

1. 应用层 ： 网络主机提供**方法和接口**，直接对应用户行为；例如 HTTP、FTP、SMTP；

2. 展示层（语法层） ：对数据 序列化，加密解密，转化，字符串编码解码；

3. 会话层：管理会话；例如 Open/Close/ReOpen/检查状态等；

4. 传输层：主机到主机的数据通信；

   - 建立连接保证数据封包发送、接受顺序一致；
   - 提供可靠性（发送者知道数据有没有完成送达）；
   - 提供流控制；
   - 提供多路复用

5. 网络层：提供数据在逻辑单元（IP 地址）之间的传递；

   - 路由：决定数据下一站在哪
   - 寻址：为数据封包增加头信息（地址等）

6. 数据链路层：提供数据在设备和设备间传输（网卡->路由器->路由器->防火墙->等等）；

   - 流控制：发送者和接收者之间同步数据的 收发速度和数据量；
   - 错误流程：检测数据有没有出错，出错并重发;

7. 物理层：定义底层一个个位（bit）的数据怎么转化为物理信号；例如：二进制怎么转化电压高低，如何转化为其他物理介质上的信号；
   - 将数据传递行为转化为物理设备识别的信号；

**注**
应用层 ------|
展示层 ------|-->用户数据
会话层 ------|
传输层 --------->数据封包
网络层 --------->帧、帧、帧
数据链路层------>二进制
物理层 --------->物理信号

## TCP/IP 协议

1. 应用层 ---->http/FTP/SMTP：应用间通信；数据
   原始数据：程序员自己定义的数据格式；

2. 传输层 ---->TCP/UDP 协议（主机到主机）；提供端口号：80；
   TCP Header:描述传输的数据；原始数据增加头部，包括原端口号，目标端口号
   TCP 数据:原始数据转化的；

3. 网络层 ---->IP 协议（IP 地址-->IP 地址）；提供 from(从哪来)IP，to（到哪去）IP
   IP Header:传输层的数据 再增加头部,包括原地址和目标地址；
   IP 数据：把传输层数据切割成一个个小块（帧）

4. 链路层 ---->多种底层网络协议 Ethernet,wifi(设备-->设备)；提供 form(原来)mac 地址，to（到哪去）mac 地址
   Frame Header: 上一层每个小块增加头部；
   Frame Data :
   Frame Footer: 上一层每个小块增加尾部；
5. 物理层 ---->

## https

https：在 http 与 TCP/IP 之间增加了 TSL/SSL 层（ HTTP --> TSL/SSL --> TCP/IP ）

**运作方式：**

- SSL：安全套接层
- TSL：传输层安全协议(更安全些)
- 需要客户端安装证书；

  1.企业生成--非对称加密的（公钥 A 、私钥 B）和对称加密的 （I、J、K）;
  企业自己生成的私有证书(公钥 A)----发送--->公信力组织----组织的私钥 签名（加密）------>加过密的签名（C）---->返回给企业；

2. 客户端请求 3 次握手后（此时不用证书加密），服务端将签过名的证书（C）发给客户端；
3. 客户端用“公信力组织的公钥（D）”解密证书（C），核对证书（C）是不是组织发布的；
4. 不是：完结； 是：将证书（C）中的公钥（A）拿出来，加密数据（协商用哪个对称加密证书- I、J、K ）发给服务器，服务器用私钥（B）解密；
5. 私钥(B)解密失败：完结；成功，通信
   ![HTTPS流程](./img/httpSProcess.png)

- 证书：有公信力的组织颁布；（只当裁判，不踢球）
- 对称加密：客户端与服务端用同样的密钥加密解密；（例如：一把锁，两把钥匙）
- 非对称加密：公钥/私钥（一个只负责加密，一个只负责解密；不能都是“加密”或都是“解密”）
  公钥：公开的，每个人能可以用（可以负责加密，也可以负责解密--只能选择一种）  
  私钥：服务端（公司，组织）私有的（可以负责加密，也可以负责解密--只能选择一种）

**注：**2 种加密方式 理论上都可以暴力破解；对称加密破解的概率大点；

## 状态码

- 301: 永久转移（和 308 对应；post 变 get）；
- 308: 永久重定向（和 301 对应；post 还是 post，不会变 get）；

- 302: Found 资源被找到-临时（以前是临时转移）--不建议使用；被拆成（303，307）;
- 303:（替代原来的 302）浏览器看到 303 自动用 get 跳转到对应的临时资源；（post 变 get）
- 307:（替代原来的 302）临时重定向（post 还是 post，不会变 get）；

- 304：资源没有修改（不返回资源，用缓存）；

## curl --- 浏览器链接代理

- 控制台敲：curl https://www.baidu.com  
  请求百度，拿到请求主体，缺少请求头

- curl -I https://www.baidu.com
  拿到请求头

## node 调试抓包工具 - Whistle

npm install Whistle; npm start;

- 需要 SwitchOmega 插件
- node.js 开发
- 支持抓包、重放、替换、修改等
