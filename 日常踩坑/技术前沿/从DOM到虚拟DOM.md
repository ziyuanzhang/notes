#

## 从 DOM 到虚拟 DOM——前端 DOM 发展史、性能与产能双赢背后的思考

切图仔 --> JQuery --> 模板语法 -->虚拟 DOM

1. 静态页面与切图——低需求下的低要求
2. JQ 时代——日益增长的需求与低下开发效率的矛盾
3. 后 JQ 时代——进一步提升效率的模板语法
4. 三大框架时代——虚拟 DOM 的狂飙

**模板语法的流程：** 数据--> 模板 -->真实 dom；  
**虚拟 DOM 的流程：** 数据--> 模版/算法/语法糖 --> 虚拟 dom --> 一系列 js 操作 --> 真实 dom；  
虚拟 DOM 是作为数据和真实 DOM 之间的缓冲层诞生的；

**虚拟 DOM 具有：**

1. 差量更新（diff 算法）
2. 批量更新（用户在短时间内对 dom 进行高频操作时，取最后一次的操作结果）

### 模板语法 VS 虚拟 DOM

- 在数据量少的情况下，两者性能相差无几。
- 数据量多的情况下，若是数据改变大，接近于全页面更新，模版语法性能更好。
- 在局部更新为主的环境下，虚拟 DOM 的性能更好

## 性能比较也要看场合

在比较性能的时候，要分清楚 初始渲染、小量数据更新、大量数据更新这些不同的场合。
Virtual DOM、脏检查 MVVM、数据收集 MVVM 在不同场合各有不同的表现和不同的优化需求。
Virtual DOM 为了提升小量数据更新时的性能，也需要针对性的优化；

- 初始渲染：Virtual DOM > 脏检查 >= 依赖收集
- 小量数据更新：依赖收集 >> Virtual DOM + 优化 > 脏检查（无法优化） > Virtual DOM 无优化
- 大量数据更新：脏检查 + 优化 >= 依赖收集 + 优化 > Virtual DOM（无法/无需优化）>> MVVM 无优化

不要天真地以为 Virtual DOM 就是快，diff 不是免费的，batching 么 MVVM 也能做，而且最终 patch 的时候还不是要用原生 API。
Virtual DOM 真正的价值从来都不是性能，而是它 1) 为函数式的 UI 编程方式打开了大门；2) 可以渲染到 DOM 以外的 backend，比如 ReactNative。
[原文](https://www.zhihu.com/question/31809713/answer/53544875)
